# AntiDDoS
Сервер tcp

Этот код представляет собой TCP-сервер с несколькими уровнями защиты от DDoS-атак и перегрузки. Давайте подробно разберем, как он работает:

. Защита от перебора подключений (Rate Limiting):

RateLimitingTCPServer — это класс, наследующий ThreadingTCPServer, который реализует логику ограничения количества подключений с одного IP-адреса.

В случае, если IP-адрес пытается установить более 10 подключений за последние 10 секунд, сервер блокирует этот IP на 60 секунд.

Все подключения отслеживаются с помощью Redis. Логика работы заключается в том, чтобы хранить метки времени для каждого подключения и проверять их на соответствие лимитам.


2. Защита от превышения трафика (Traffic Limiting):

MyTCPHandler — это обработчик запросов, который отслеживает трафик от каждого клиента.

Для каждого клиента хранится информация о количестве данных, переданных за последнюю секунду.

Если IP-адрес передает более 30 МБ в секунду, он блокируется на 60 секунд, и в логах появляется предупреждение.

Для каждого клиента создается уникальный ключ в Redis для отслеживания трафика.


3. Сетевой мониторинг и анализ:

В коде также есть функция analyze_behavior, которая анализирует текущую нагрузку на систему.

Она использует библиотеку psutil для получения информации о текущих сетевых соединениях, загрузке процессора и памяти, что позволяет отслеживать текущие ресурсы сервера.


4. Настройка защиты с помощью iptables:

Для защиты на уровне операционной системы используется утилита iptables, которая настраивает правила для блокировки подозрительных подключений.

Пример правила: если на порт 9999 поступает слишком много новых соединений за короткий промежуток времени (в пределах 60 секунд), то такие соединения блокируются.


5. Многоуровневая защита:

В функции setup_cdn_and_load_balancer предполагается использование внешних решений для фильтрации трафика, таких как CDN и балансировщики нагрузки. Это позволяет снизить нагрузку на сервер.


6. Запуск сервера:

Сервер запускается на порту 9999 и работает с помощью многозадачности (ThreadingTCPServer), обрабатывая каждое подключение в отдельном потоке.

В фоновом режиме также запускается мониторинг системных метрик, который периодически анализирует нагрузку и состояние системы.


7. Логирование:

Логи записываются в файл server.log, что позволяет отслеживать подключения, блокировки, ошибки и другие важные события.
